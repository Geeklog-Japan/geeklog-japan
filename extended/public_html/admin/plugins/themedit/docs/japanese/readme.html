<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<link rel="stylesheet" type="text/css" href="../docstyle.css">
	<title>Geeklog テーマエディタプラグイン</title>
</head>

<body>
<h1>Geeklogテーマエディタプラグイン [v1.2.2]</h1>
by mystral-kk [<a href="mailto:geeklog@mystral-kk.net">geeklog@mystral-kk.net</a>]<br>
2017年 1月10日

<h2>目次</h2>

<ul>
	<li><a href="#description">概要</a></li>
	<li><a href="#version">改訂履歴</a></li>
	<li><a href="#thanks">謝辞</a></li>
	<li><a href="#install">プラグインのインストール</a></li>
	<li><a href="#uninstall">プラグインのアンインストール</a></li>
	<li><a href="#upgrade">プラグインのアップグレード</a></li>
	<li><a href="#usage">使用法</a></li>
	<li><a href="#license">ライセンス</a></li>
</ul>

<a name="description"></a><h3>概要</h3>
<p>テーマエディタを使うと、オンラインでテンプレートファイル(*.thtml)とカスケィディングスタイルシートファイル(*.css)を編集できます。このプラグインを使えば、テンプレートファイルを変更する度にアップロードする必要はなくなります。</p>

<a name="version"></a><h3>改訂履歴</h3>
<table border="1">
	<tr>
		<th>日付</th><th>バージョン</th><th>説明</th>
	</tr>
	<tr>
		<td>2017年 1月10日</td><td>1.2.2</td><td><span class="fixed">修正</span> PHP-7とGeeklog-2.1.2で動くようになりました。</td>
	</tr>
	<tr>
		<td>2012年 4月22日</td><td>1.2.1</td><td><span class="fixed">修正</span> アンインストール時に、環境によってはエラーが発生するバグを修正しました。</td>
	</tr>
	<tr>
		<td>2011年11月 6日</td><td>1.2.0</td><td><span class="fixed">修正</span> Geeklog-1.6で導入された自動インストールに対応しました。</td>
	</tr>
	<tr>
		<td>2010年 7月 4日</td><td>1.1.5</td><td><span class="fixed">修正</span> 不適切な&lt;meta&gt;、&lt;br&gt;タグを修正しました。</td>
	</tr>
	<tr>
		<td>2009年11月 4日</td><td>1.1.4</td><td><span class="fixed">修正</span> 英語・日本語以外の言語を選択した場合に文字化けが起こるバグを修正しました。</td>
	</tr>
	<tr>
		<td>2008年 9月26日</td><td>1.1.3</td><td><span class="fixed">修正</span> 大文字小文字を区別しないファイルシステム（MS Windowsなど）で、インクルードファイルが直接アクセスされるのを防ぐ措置を追加しました。</td>
	</tr>
	<tr>
		<td>2008年 9月14日</td><td>1.1.2</td><td><span class="fixed">修正</span> PHP-4.xで起こるエラーを避けるため、htmlentities(), html_entity_decode()関数を使用しないようにしました。</td>
	</tr>
	<tr>
		<td>2008年 8月18日</td><td>1.1.1</td><td><span class="fixed">修正</span> DokuWikiプラグインと協調できるように修正しました。</td>
	</tr>
	<tr>
		<td>2008年 8月11日</td><td>1.1.0</td><td><span class="new">新規</span> Geeklog-1.5.0でも動作するよう更新。<br><span class="new">新規</span> Geeklog-1.5.0のコンフィギュレーションUIを使用するよう更新。</td>
	</tr>
	<tr>
		<td>2007年 3月29日</td><td>1.0.5</td><td><span class="fixed">修正</span> アポストロフィを含むパスを正しく処理するように変更。<br><span class="new">新規</span> すべてのテーマを自動的に利用可能にするオプションを追加。（<a href="#config">プラグインの設定</a>を参照のこと。）<br><span class="new">新規</span> テーマに関するすべてのファイル(*.thtml, *.css)を自動的に利用可能にするオプションを追加。（<a href="#config">プラグインの設定</a>を参照のこと。）</td>
	</tr>
	<tr>
		<td>2006年12月21日</td><td>1.0.4</td><td><span class="new">新規</span> 各テーマディレクトリ下の images ディレクトリに画像をアップロードする機能を追加。<br><span class="new">新規</span> ファイル名ドロップダウンリストで、ファイル名ではなく機能名を表示するように変更。</td>
	</tr>
	<tr>
		<td>2006年11月 7日</td><td>1.0.3</td><td><span class="fixed">修正</span> デフォルトの言語が日本語の場合に対応(Thanks, Kemal and Tsuchi)。<br><span class="new">新規</span> テンプレートファイル名を大幅に追加(Thanks, Ivy)。</td>
	</tr>
	<tr>
		<td>2006年11月 2日</td><td>1.0.2</td><td><span class="fixed">修正</span> magic_quotes_gpcがオンの場合に対応(Thanks, samstone)。</td>
	</tr>
	<tr>
		<td>2006年10月 1日</td><td>1.0.0</td><td>初期バージョン</td>
	</tr>
</table>

<a name="thanks"></a><h3>謝辞</h3>
<ul>
	<li>有益なアイデアを提供してくれたGeeklog.jpのメンバーに、</li>
	<li>Geeklogを開発・維持してくれるGeeklogのコア開発チームに、</li>
</ul>
感謝します。

<a name="install"></a><h3>プラグインのインストール</h3>

<p>以下の説明で、</p>
<ul>
	<li><span class="geeklog">&lt;geeklog_dir&gt;</span>は、システムの config.php が存在するディレクトリ</li>
	<li><span class="admin">&lt;admin&gt;</span>は、管理者用ファイルが存在するディレクトリ（ふつうは、<span class="public">&lt;public_html&gt;</span>ディレクトリの下）</li>
</ul>
<p>を表しています。</p>

<ol>
	<li>テーマエディタプラグインはテーブルを追加するので、管理者メニューの「DBのバックアップ」やphpMyAdminを使用して、事前にGeeklogのデータベースをバックアップしておきます。</li>
	<li>テーマエディタプラグインのアーカイブを<span class="geeklog">&lt;geeklog_dir&gt;</span>/pluginsディレクトリに展開します。themeditという名前のディレクトリができます。</li>
	<li>adminディレクトリを作ります。<span class="admin">&lt;admin&gt;</span>/plugins/ ディレクトリの下に themeditという名前のディレクトリを作ります。</li>
	<li><span class="geeklog">&lt;geeklog_dir&gt;</span>/plugins/themedit/ ディレクトリに移動します。adminディレクトリの内容を、3.で作成した <span class="admin">&lt;admin&gt;</span>/plugins/themedit/ ディレクトリにコピーします。</li>
	<li>themeditディレクトリの config.php ファイルを編集し、データベースのテーブルのプレフィックスと編集対象テーマ、編集対象ファイルなどを設定します。デフォルトでは、Geeklogのテーブルのプレフィックスを使用し、themedit admin以外のアクセスを認めないようになっています。</li>
	<li>Rootユーザーとしてログインし、プラグインエディタからインストールを実行します。失敗した場合には、エラーログ（error.log）を調べます。この時点で、テーマエディタプラグインはインストールされ、機能しているはずです。テーマエディタアイコンをクリックすると、管理機能ページへジャンプするでしょう。</li>
	<li>セキュリティを設定します。インストール直後には、テーマエディタプラグインの管理権限(themedit admin)を持っているのは、Rootユーザーだけです。ユーザーエディタやグループエディタを使用して、管理権限を他の人やグループに委譲することができます</li>
	<li><strong>[***** 注意1 *****]</strong>　編集するテーマが入っているディレクトリのパーミッションを<strong>757</strong>、編集するファイルのパーミッションを<strong>646</strong>に変更する必要があります。</li>
	<li><strong>[***** 注意2 *****]</strong>　<span class="admin">&lt;admin&gt;</span>/plugins/ ディレクトリ内の preview.html と preview.css のパーミッションを<strong>646</strong>に変更する必要があります。</li>
</ol>
<p>注意: テーマエディタプラグインではかなりJavaScriptを使用しています。快適な操作性を得るには、JavaScriptをオンにすることを強くお勧めします。</p>

<a name="uninstall"></a><h3>プラグインのアンインストール</h3>

<ol>
	<li>プラグインエディタから、テーマエディタプラグインをアンインストールします。このとき、テーマエディタプラグインが使用していたテーブルは破棄され、その中に記録されていたデータも削除されます。</li>
	<li>インストールの過程で作成した 2つのディレクトリ（<span class="geeklog">&lt;geeklog-dir&gt;</span>/plugins/themedit/ と <span class="admin">&lt;admin&gt;</span>/plugins/themedit/ を削除します。</li>
	<li><strong>[***** 注意 *****]</strong>　インストール時に変更したディレクトリとファイルのパーミッションを元に戻します。たとえば、ディレクトリは<strong>755</strong>、ファイルは<strong>644</strong>に変更します。</li>
</ol>

<a name="upgrade"></a><h3>プラグインのアップグレード</h3>
<p>新しいアーカイブを展開（解凍）してできたファイルをすべてWebサーバにアップロードし、プラグインエディタから「編集」-「更新」を実行するだけです。</p>

<a name="usage"></a><h3>使用法</h3>
<p>テーマエディタプラグインはとてもシンプルなので、ほとんど直感的に使えます。</p>
<ol>
	<li>編集したいテーマをドロップダウンリストから選択します。<br><strong>注意</strong>：選択できるテーマ名は <tt>config.php</tt> 中の <tt>$_THM_CONF['allowed_themes']</tt> で定義されています。必要に応じて変更してください。</li>
	<li>編集したいファイルをドロップダウンリストから選択します。<br><strong>注意</strong>：選択できるファイル名は <tt>config.php</tt> 中の <tt>$_THM_CONF['allowed_files']</tt> で定義されています。必要に応じて変更してください。</li>
	<li>使用可能なテンプレート変数の一覧が表示されます。</li>
	<li>テンプレート変数名が書かれたボタンをクリックすると、編集画面のキャレットの位置に対応するタグが挿入されます。<br><strong>注意</strong>: JavaScriptを有効にしないとこのボタンは使えません。</li>
	<li>「プレビュー」ボタンをクリックすると、編集内容のプレビューが別のページで表示されます。</li>
	<li>「保存」ボタンをクリックすると、編集内容がWeb上に保存されます。</li>
	<li>「初期設定に戻す」ボタンをクリックすると、ファイルの内容はこのプラグインがインストールされた時点の内容に戻ります。</li>
	<li>「画像」ボタンをクリックすると、シンプルな画像ブラウザが表示されます。サポートされている画像タイプは'jpg', 'jpeg', 'png', 'gif'です。テーマ名とディレクトリ名のドロップダウンリストを選択することでブラウズできます。画像をアップロードするときには、「参照...」ボタンをクリックして選択し、「アップロード」ボタンをクリックします。画像ファイルを削除したい場合は、該当のファイルにチェックを入れて、「削除」ボタンをクリックします。<strong>削除は確認なしに行われるので、注意してください。</strong>やり直しはできません。</li>
</ol>

<a name="license"></a><h3>ライセンス</h3>
<p>テーマエディタプラグインはGPLv2以降です。</p>

<div id="copyright">Copyright &copy; 2006-2017 mystral-kk</div>
</body>
</html>
